package com.report;

import java.io.FileInputStream;

import org.apache.poi.ss.usermodel.Cell;
import org.apache.poi.ss.usermodel.Workbook;
import org.apache.poi.ss.usermodel.WorkbookFactory;
import org.openqa.selenium.By;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.WebElement;
import org.openqa.selenium.chrome.ChromeDriver;

import cucumber.api.java.Before;
import cucumber.api.java.en.Given;
import cucumber.api.java.en.Then;
import cucumber.api.java.en.When;

public class Hokandbeckend 
{
	String path="E:\\data.xlsx";
	public WebDriver driver;
	String username=Excel.getCellValue(path, "Sheet1", 1, 0);
	String password=Excel.getCellValue(path, "Sheet1", 2, 0);
	
	@Before
	public void launchBrowser()
	{
		driver=new ChromeDriver();
		driver.manage().window().maximize();
		driver.get("http://automationpractice.com/index.php");
		driver.manage().deleteAllCookies();
	}


@Given("^Open Login page$")
public void open_Login_page()  
{
	
	String xpath=".//a[@class='login']";
    WebElement login=driver.findElement(By.xpath(xpath));
    login.click();
}

@When("^Enter valid usename$")
public void enter_valid_usename()  
{

	FileInputStream fi= new FileInputStream(path);
	Workbook book=WorkbookFactory.create(fi);
	int row=book.getSheet("Sheet1").getRow(0).getLastCellNum();
	int col=book.getSheet("Sheet1").getRow(0).getLastCellNum();
	Cell cell=book.getSheet("Sheet1").getRow(row).getCell(col);
	for(int i=0;i<=row;i++)
	{
		 for(int j=0;j<col;j++)
		 {
			  String xpath1=".//input[@id='email']";
			    WebElement user=driver.findElement(By.xpath(xpath1));
			    user.sendKeys(user);
		 }
	}
  
    String xpath2=".//input[@id='passwd']";
    WebElement pass = driver.findElement(By.xpath(xpath2));
    pass.sendKeys(pass);
}

@When("^Enter valid password and click on submit button$")
public void enter_valid_password_and_click_on_submit_button()  {
    
}

@Then("^Login should sucess$")
public void login_should_sucess() {
   
}

@Given("^Home page of the Email$")
public void home_page_of_the_Email() {
   
}

@When("^Click on the Inbox link$")
public void click_on_the_Inbox_link() {
    
}

@Then("^Inbox should display all the mails$")
public void inbox_should_display_all_the_mails()  {
    
}


}
